<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <!-- <meta http-equiv="X-UA-Compatible" content="IE=edge"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Salon Beatles</title>
  <!-- icono del la pestaña -->
  <link rel="shortcut icon" href="./Biblioteca/Gifs/nerv.gif">
  <!-- link de la libreria para leer las etiquetas de aframe -->
<script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
<!-- script para gifs -->
<script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>
<script src="https://rawgit.com/mayognaise/aframe-gif-component/master/dist/aframe-gif-component.min.js"></script>
<!-- para leer animación -->
<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
<!-- script para texturas -->
<script src="https://cdn.jsdelivr.net/npm/aframe-enviropacks@latest/aframe-enviropacks.js"></script>
<!-- script para texto en 3d -->
<script src="https://unpkg.com/aframe-text-geometry-component@0.5.2/dist/aframe-text-geometry-component.min.js"></script>
<!-- script para interacciones -->
<script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
<!-- LIBRERIAS DE COLISIONES Y FÍSICAS-->
<script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script>
<!-- scripts movimiento de la cámara -->
<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
<script src="https://unpkg.com/super-hands@2.0.2/dist/super-hands.min.js"></script>
<!-- scripts para partículas-->
<script src="https://unpkg.com/aframe-animation-component@3.2.1/dist/aframe-animation-component.min.js"></script>
<script src="https://unpkg.com/aframe-particle-system-component@1.1.3/dist/aframe-particle-system-component.min.js"></script>
<script src="https://unpkg.com/aframe-extras.ocean@latest/dist/aframe-extras.ocean.min.js"></script>
<script src="https://unpkg.com/aframe-gradient-sky@1.2.0/dist/gradientsky.min.js"></script>
<!-- scripts para enviroments-->
<script src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
<!-- scipts para animacion de agua -->
<script src="https://unpkg.com/aframe-animation-component@3.2.1/dist/aframe-animation-component.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.ocean.min.js"></script>
<script src="https://unpkg.com/aframe-animation-component@3.2.1/dist/aframe-animation-component.min.js"></script>

  <!-- scripts para truco de transparencia en modelos 3d-->
  <script>
      AFRAME.registerComponent('model-opacity', {
          schema: { default: 1.0 },
          init: function () {
              // this.el.addEventListener('model-loaded', this.update.bind(this));
              this.el.addEventListener("model-loaded", () => {
                  const object3DEl = this.el.object3DMap;
                  ;








                  var mesh = this.el.getObject3D('mesh'); // For hand, the result is undefined
                  // var mesh = this.el.object3DMap.mesh; // For hand, the result is undefined
                  console.log(mesh);
                  var data = this.data;
                  if (!mesh) { return; }
                  mesh.traverse(function (node) {
                      if (node.isMesh) {
                          ;
                          node.material.opacity = data;
                          node.material.transparent = data < 1.0;
                          node.material.needsUpdate = true;
                      }
                  });
              }, 2000)
















          },
          update: function () {
              var mesh = this.el.getObject3D('mesh');
              var data = this.data;
              if (!mesh) { return; }
              mesh.traverse(function (node) {
                  if (node.isMesh) {
                      ;
                      node.material.opacity = data;
                      node.material.transparent = data < 1.0;
                      node.material.needsUpdate = true;
                  }
              });
          }
      });
  </script>
</head>
  
  <body>
    <a-scene light="defaultLightsEnabled: false" fog="color: #FFFFFF; far: 12; density:.3" shadow="type: basic" physics="gravity: 0; debug: false" reflection="directionalLight:a-light#dirlight;">
      <a-asset>
        <!-- Texturas -->
        <img id="piso" src="./Biblioteca/Sala 1 Beatles/Texturas/Piso.jpg">
        <img id="pared" src="./Biblioteca/Sala 1 Beatles/Texturas/Pared.jpg">

        <!-- Señaletica -->
        <img id="salida" src="./Biblioteca/Sala 1 Beatles/Señaletica/Salida.png">

        <!-- logos -->

        <img id="beatles_logo" src="./Biblioteca/Imagenes/logos/Beatles logo.png">
        <img id="queen_logo" src="./Biblioteca/Imagenes/logos/Queen logo.png">
        <img id="led_logo" src="./Biblioteca/Imagenes/logos/led.png">
        <img id="rolling_logo" src="./Biblioteca/Imagenes/logos/rolling logo.png">
        <img id="hendrix_logo" src="./Biblioteca/Imagenes/logos/hendrix logo.png">
        <img id="elvis_logo" src="./Biblioteca/Imagenes/logos/elvis logo.png">

        <!-- modelos -->

        <a-asset-item id="Puerta" src="./Biblioteca/Modelos/puerta_de_madera/scene.gltf"></a-asset-item>
        <a-asset-item id="estatua" src="./Biblioteca/Sala 1 Beatles/Modelos/the_beatles_statue/scene.gltf"></a-asset-item>

        <!-- animados -->
        <a-asset-item id="A1" src="./Biblioteca/Modelos/con animacion/A1/A1.gltf"></a-asset-item>
        <!-- música-->
        <audio id="backgroundMusic" autoplay loop="true" src="./Biblioteca/Sala 1 Beatles/Audio/The Beatles Please Please Me Full Album.mp3"></audio>
        <!-- video-->
        <video id="historia" controls="true" src="./Biblioteca/Sala 1 Beatles/Video/La Historia The Beatles _ Las Historias Del Rock.mp4"></video>
      
      
      </a-asset>


      <!-- camara -->
      <a-entity movement-controls kinematic-body>
        <a-entity 
        id="camera" 
        camera position="0 1.6 3" 
        look-controls >
        <a-entity cursor="fuse: false;" 
        position="0 0 -1" 
        geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.011" material="color: #FFffff; shader: flat"></a-entity></a-entity></a-entity>

        <!-- luz general -->
        <a-sphere 
          position="0 5.5 0" 
          rotation="0 0 0"
          material="color: #EBE501 Cast castShadow: true"  
          scale=".3 .3. .3" 
          light="type: point; color: #FFFFFF; castShadow: True; intensity: 1;" 
          ></a-sphere>
      <!-- Paredes -->
      <a-box 
        position="6 3 0" 
        rotation="0 0 0" 
        material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
        scale=".5 6 12" 
        side="double"
        static-body
        ></a-box>
        <a-box 
        position="-6 3 0" 
        rotation="0 0 0" 
        material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
        scale=".5 6 12" 
        side="double"
        static-body
        ></a-box>
        <a-box 
        position="0 3 6" 
        rotation="0 90 0" 
        material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
        scale=".5 6 12" 
        side="double"
        static-body
        ></a-box>
        <a-box 
        position="0 3 -6" 
        rotation="0 90 0" 
        material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
        scale=".5 6 12" side="double"
        static-body
        ></a-box>
      
      
      <!-- Suelo -->
      <a-plane static-body 
      position="0 0 0" 
      rotation="-90 0 0" 
      color="#0e23aa" 
      scale="50 50" 
      opacity="0"></a-plane>
      <a-box 
      position="0 0 0" 
      rotation="0 90 0" 
      material="src:#piso; repeat: 10 10; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
      scale="20 .5 20" 
      side="double"
      static-body
      ></a-box>

      <!-- Techo -->
      <a-box 
      position="0 5 0" 
      rotation="0 90 0" 
      material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
      scale="12 .5 12" 
      side="double"
      ></a-box>

      <a-entity 
       gltf-model="#estatua" 
       position="0 0 -4" 
       rotation="0 -180 0" 
       scale=".2 .2 .2" 
       material="flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true"></a-entity>

      

      <!-- Puerta de salida -->
      <a-entity
      position="0 0 5.75"
      rotation="0 180 0" 
      event-set__1="_event: mouseenter; _target: #PS; intensity:3; color: #EB291A; angle:25"
      event-set__2="_event: mouseleave; _target: #PS; intensity:1.5; color: #FFFFFF; angle:15">
        <!-- Logo -->
        <a-image 
        src="#salida" 
        position=".04 2.5 .1" 
        width="1"
        height=".5" 
        side="double" 
        material="shader: standard; flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true; transparent: true; opacity: 1"
        ></a-image>
       <!-- Spot puerta -->
       <a-light 
       id="PS"
       type="spot" 
       color="#FFffff" 
       position="0 0 4" 
       rotation="15 0 0" 
       intensity="1.5" 
       angle="15" 
       penumbra="0.4" 
       castshadow="true"
       animation="property: rotation; to: 5 0 ; dir: alternate; easeInElastic: linear; loop: true;dur: 1500"
       ></a-light>
       <!-- Puerta -->
       <a-entity 
       gltf-model="#Puerta" 
       position="0 0 .9" 
       rotation="0 0 0" 
       scale=".5 .5 .5" 
       material="flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true" 
       link="href: index.html" 
       clickable></a-entity>
       <!-- modelo animado -->
       <a-entity 
       gltf-model="#AS" 
       position=".8 .21 0.5" 
       rotation="0 0 0" 
       scale="1 1 1" 
       material="flatShading: true; metalness: 0; roughness: 0; castShadow: true; receiveShadow: true" 
       animation-mixer
       ></a-entity>
      </a-entity>

      <a-assets>
        <audio id="backgroundMusic" src="ruta/a/musica.mp3"></audio>
        <video id="historia" src="https://www.youtube.com/watch?v=GDhAgTNQg3E&ab_channel=LasHistoriasdelRock"></video>
      </a-assets>
      
      <a-entity sound="src: #backgroundMusic; autoplay: true; loop: true"></a-entity>
      <a-video id="video" src="#historia" width="16" height="9" position="0 1.6 -5" scale=".5 .5. .5" ></a-video>
      
      <a-sphere id="playSphere" position="-1 1.25 -3" radius="0.2" color="#EF2D5E"
        animation__click="property: scale; startEvents: click; to: 1.1 1.1 1.1; dir: alternate"
        animation__color="property: color; startEvents: click; to: #FF0000; dir: alternate"
        animation__reset="property: scale; startEvents: reset; delay: 2000; dur: 500; to: 1 1 1"
        animation__resetColor="property: color; startEvents: reset; delay: 2000; dur: 500; to: #EF2D5E">>
        
      </a-sphere>
      
      <a-sphere id="pauseSphere" position="1 1.25 -3" radius="0.2" color="#FFC65D"
        animation__click="property: scale; startEvents: click; to: 1.1 1.1 1.1; dir: alternate"
        animation__color="property: color; startEvents: click; to: #0000FF; dir: alternate"
        animation__reset="property: scale; startEvents: reset; delay: 2000; dur: 500; to: 1 1 1"
        animation__resetColor="property: color; startEvents: reset; delay: 2000; dur: 500; to: #EF2D5E">>
      </a-sphere>
      
      <script>
        var videoEl = document.querySelector('#video');
        var video = document.querySelector('#historia');
        var backgroundMusic = document.querySelector('#backgroundMusic');
        var playSphere = document.querySelector('#playSphere');
        var pauseSphere = document.querySelector('#pauseSphere');
      
        playSphere.addEventListener('click', function () {
          video.play();
          backgroundMusic.pause();
          playSphere.emit('reset');
        });
      
        pauseSphere.addEventListener('click', function () {
          video.pause();
          backgroundMusic.play();
          pauseSphere.emit('reset');
        });
      </script>
      <div class="a-loader-title" style="display: none;">Proyecto</div>
    </a-scene>
  </body>
</html>