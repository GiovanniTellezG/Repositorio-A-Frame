<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <!-- <meta http-equiv="X-UA-Compatible" content="IE=edge"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Salon Beatles</title>
  <!-- icono del la pestaña -->
  <link rel="shortcut icon" href="./Biblioteca/Gifs/nerv.gif">
<!-- link de la libreria para leer las etiquetas de aframe -->
<script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
<script src="https://cdn.rawgit.com/zcanter/aframe-gradient-sky/master/dist/gradientsky.min.js"></script>
<!-- script mirror -->
<script src="https://unpkg.com/aframe-mirror-component/dist/aframe-mirror-component.min.js"></script>
<!-- script para gifs -->
<script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>
<script src="https://rawgit.com/mayognaise/aframe-gif-component/master/dist/aframe-gif-component.min.js"></script>
<!-- para leer animación -->
<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
<!-- script para texturas -->
<script src="https://cdn.jsdelivr.net/npm/aframe-enviropacks@latest/aframe-enviropacks.js"></script>
<!-- script para texto en 3d -->
<script src="https://unpkg.com/aframe-text-geometry-component@0.5.2/dist/aframe-text-geometry-component.min.js"></script>
<!-- script para interacciones -->
<script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
<!-- LIBRERIAS DE COLISIONES Y FÍSICAS-->
<script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script>
<!-- scripts movimiento de la cámara -->
<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
<script src="https://unpkg.com/super-hands@2.0.2/dist/super-hands.min.js"></script>
<!-- scripts para partículas-->
<script src="https://unpkg.com/aframe-animation-component@3.2.1/dist/aframe-animation-component.min.js"></script>
<script src="https://unpkg.com/aframe-particle-system-component@1.1.3/dist/aframe-particle-system-component.min.js"></script>
<script src="https://unpkg.com/aframe-extras.ocean@latest/dist/aframe-extras.ocean.min.js"></script>
<!-- scripts para enviroments-->
<script src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
<!-- scipts para animacion de agua -->
<script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.0.0/dist/aframe-extras.min.js"></script>

  <!-- scripts para truco de transparencia en modelos 3d-->
  <script>
      AFRAME.registerComponent('model-opacity', {
          schema: { default: 1.0 },
          init: function () {
              // this.el.addEventListener('model-loaded', this.update.bind(this));
              this.el.addEventListener("model-loaded", () => {
                  const object3DEl = this.el.object3DMap;
                  ;








                  var mesh = this.el.getObject3D('mesh'); // For hand, the result is undefined
                  // var mesh = this.el.object3DMap.mesh; // For hand, the result is undefined
                  console.log(mesh);
                  var data = this.data;
                  if (!mesh) { return; }
                  mesh.traverse(function (node) {
                      if (node.isMesh) {
                          ;
                          node.material.opacity = data;
                          node.material.transparent = data < 1.0;
                          node.material.needsUpdate = true;
                      }
                  });
              }, 2000)
















          },
          update: function () {
              var mesh = this.el.getObject3D('mesh');
              var data = this.data;
              if (!mesh) { return; }
              mesh.traverse(function (node) {
                  if (node.isMesh) {
                      ;
                      node.material.opacity = data;
                      node.material.transparent = data < 1.0;
                      node.material.needsUpdate = true;
                  }
              });
          }
      });
  </script>
</head>
  
  <body>
    <a-scene light="defaultLightsEnabled: false" fog="color: #FFFFFF; far: 12; density:.5" shadow="type: basic" physics="gravity: 0; debug: false" reflection="directionalLight:a-light#dirlight;">
      <a-asset>

        <!-- Texturas -->
        <img id="piso" src="./Biblioteca/Sala 1 Beatles/Texturas/Piso.jpg">
        <img id="pared" src="./Biblioteca/Sala 1 Beatles/Texturas/Pared.jpg">
         <!-- madera -->
         <img id="M1diffuse" src="./Biblioteca/Texturas/M1/M1diff_1k.jpg">
         <img id="M1roughness" src="./Biblioteca/Texturas/M1/M1rough_1k.jpg">
         <img id="M1normal" src="./Biblioteca/Texturas/M1/M1nor_gl_1k.jpg">
         <!-- Metal bronce -->
         <img id="M2diffuse" src="./Biblioteca/Texturas/M2/MetalBronzeWorn001_COL_2K_METALNESS.png">
         <img id="M2roughness" src="./Biblioteca/Texturas/M2/MetalBronzeWorn001_ROUGHNESS_2K_METALNESS.png">
         <img id="M2normal" src="./Biblioteca/Texturas/M2/MetalBronzeWorn001_NRM_2K_METALNESS.png">
         <img id="M2metalness" src="./Biblioteca/Texturas/M2/MetalBronzeWorn001_ROUGHNESS_2K_METALNESS.png">

        <!-- Señaletica -->
        <img id="salida" src="./Biblioteca/Señaletica/Salida.png">

        <!-- logos -->

        <img id="beatles_logo" src="./Biblioteca/Imagenes/logos/Beatles logo.png">
        <img id="queen_logo" src="./Biblioteca/Imagenes/logos/Queen logo.png">
        <img id="led_logo" src="./Biblioteca/Imagenes/logos/led.png">
        <img id="rolling_logo" src="./Biblioteca/Imagenes/logos/rolling logo.png">
        <img id="hendrix_logo" src="./Biblioteca/Imagenes/logos/hendrix logo.png">
        <img id="elvis_logo" src="./Biblioteca/Imagenes/logos/elvis logo.png">

        <!-- modelos -->
        <a-asset-item id="estatua" src="./Biblioteca/Sala 1 Beatles/Modelos/the_beatles_statue/scene.gltf"></a-asset-item>
        <a-asset-item id="rockola" src="./Biblioteca/Sala 1 Beatles/Modelos/grabadora/scene.gltf"></a-asset-item>
        <a-asset-item id="sillon" src="./Biblioteca/Sala 1 Beatles/Modelos/Sillon/scene.gltf"></a-asset-item>
        <a-asset-item id="cuadros" src="./Biblioteca/Sala 1 Beatles/Modelos/Cuadros beatles/scene.gltf"></a-asset-item>
        <a-asset-item id="cabina" src="./Biblioteca/Sala 1 Beatles/Modelos/cabina telefonica/scene.gltf"></a-asset-item>
        

        <!-- animados -->
        <a-asset-item id="A1" src="./Biblioteca/Modelos/con animacion/A1/A1.gltf"></a-asset-item>
        
        <!-- Audio -->
        <audio id="backgroundMusic" src="./Biblioteca/Sala 1 Beatles/Audio/Love Me Do.mp3"></audio>
        
        <!-- video-->
        <video id="historia" controls="true" src="./Biblioteca/Sala 1 Beatles/Videos/Beatleshistoria.mp4"></video>

        <!-- tipografía -->
        <a-asset-item id="font" src="https://raw.githubusercontent.com/etiennepinchon/aframe-fonts/master/fonts/montserrat/Montserrat-Regular.json"></a-asset-item>

        <!-- disco -->
        <img id="discoBeatles" src="./Biblioteca/Sala 1 Beatles/Disco/Disco.png">
      
      
      </a-asset>

      <!-- camara -->
      <a-entity 
       movement-controls 
       kinematic-body>
        <a-entity 
         id="camera" 
         camera position="0 1.6 0" 
         look-controls >
          <a-entity 
           cursor="fuse: false;"
           position="0 0 -.1" 
           geometry="primitive: ring; radiusInner: 0.001; radiusOuter: 0.002" material="color: #000000; shader: flat">
          </a-entity>
        </a-entity>
      </a-entity>

        <!-- luz general -->
        <a-sphere 
          position="0 4 0" 
          rotation="0 0 0"
          color="#FFFFFF"
          scale=".1 .1 .1" 
          light="type: point; color: #FFFFFF; castshadow:true; intensity: 1" 
          ></a-sphere>
      <!-- Paredes -->
      <a-box 
        position="6 3 0" 
        rotation="0 0 0" 
        material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
        scale=".5 6 12" 
        side="double"
        static-body>
      </a-box>
      <a-box 
       position="-6 3 0" 
       rotation="0 0 0" 
       material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
       scale=".5 6 12" 
       side="double"
       static-body>
      </a-box>
      <a-box 
       position="0 3 6" 
       rotation="0 90 0" 
       material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
       scale=".5 6 12" 
       side="double"
       static-body>
      </a-box>
      <a-box 
       position="0 3 -6" 
       rotation="0 90 0" 
       material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
       scale=".5 6 12" side="double"
       static-body>
      </a-box>

      <!-- Suelo -->
      <a-plane 
       static-body 
       position="0 0 0" 
       rotation="-90 0 0" 
       color="#0e23aa" 
       scale="50 50" 
       opacity="0">
      </a-plane>
      <a-box 
       position="0 0 0" 
       rotation="0 90 0" 
       material="src:#piso; repeat: 10 10; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
       scale="20 .5 20" 
       side="double"
       static-body>
      </a-box>

      <!-- Techo -->
      <a-box 
       position="0 5 0" 
       rotation="0 90 0" 
       material="src:#pared; repeat: 3 3; flatShading: true; metalness: 0; roughness: 1; receiveShadow:true; castShadow: true" 
       scale="12 .5 12" 
       side="double">
      </a-box>

      <!-- estatua -->
      <a-entity 
       gltf-model="#estatua" 
       position="-4 0.2 -4" 
       rotation="0 -130 0" 
       scale=".15 .15 .15" 
       material="flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true"
       static-body>
      </a-entity>

      <!-- Sillones -->
      <!-- sillon 1 -->
      <a-entity 
      gltf-model="#sillon" 
      position="-3 .25 5" 
      rotation="0 80 0" 
      scale="1.5 1.5 1.5" 
      material="flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true"
      static-body>
     </a-entity>
     <!-- sillon 2 -->
     <a-entity 
      gltf-model="#sillon" 
      position="2 .25 5" 
      rotation="0 95 0" 
      scale="1.5 1.5 1.5" 
      material="flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true"
      static-body>
     </a-entity>

     <!-- Cuadros -->
     <a-entity 
      gltf-model="#cuadros" 
      position="-5 2 0" 
      rotation="0 90 0" 
      scale="2 2 2" 
      material="flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true"
      static-body>
     </a-entity>

     <!-- Cabina -->
     <a-entity 
      gltf-model="#cabina" 
      position="4.9 .2 3.5" 
      rotation="0 -90 0" 
      scale="2 2 2" 
      material="flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true"
      static-body>
     </a-entity>


      <!-- modelo animado -->
      <a-entity
       gltf-model="#A1"
       position="1 .21 -5"
       rotation="0 0 0" 
       scale="1 1 1"
       material="flatShading: true; metalness: 0; roughness: 0; castShadow: true; receiveShadow: true"
       animation-mixer>
      </a-entity>
             
      <!-- Puerta de salida -->
      <a-entity
      position="0 0 5.75"
      rotation="0 180 0" 
      event-set__1="_event: mouseenter; _target: #PS; intensity:3; color: #EB291A; angle:25"
      event-set__2="_event: mouseleave; _target: #PS; intensity:1.5; color: #FFFFFF; angle:15">
        <!-- Logo -->
        <a-image 
        src="#salida" 
        position=".04 2 .1" 
        width="1"
        height=".5" 
        scale=".5 .5 .5"
        side="double" 
        material="shader: standard; flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true; transparent: true; opacity: 1"
        ></a-image>
       <!-- Spot puerta -->
       <a-light 
       id="PS"
       type="spot" 
       color="#FFffff" 
       position="0 0 4" 
       rotation="15 0 0" 
       intensity="1.5" 
       angle="15" 
       penumbra="0.4" 
       castshadow="true"
       animation="property: rotation; to: 5 0 ; dir: alternate; easeInElastic: linear; loop: true;dur: 1500"
       ></a-light>
       <!-- Puerta -->
       <a-entity 
       position="0 1.5 0"
       rotation="0 90 0"
       link="href: index.html" 
       clickable
       ><a-box position="0 0 0" rotation="0 0 0" material="src: #M1diffuse; roughnessMap: #M1roughness; normalMap: #M!normal; repeat:1 1; flatShading: true; receiveShadow:true; castShadow: true" scale=".1 2.5 1.2" side="double"></a-box>
       <!-- Marco -->
       <a-box position="0 0 .6" rotation="0 0 0" material="src: #M1diffuse; roughnessMap: #M1roughness; normalMap: #M!normal; repeat:1 1; flatShading: true; receiveShadow:true; castShadow: true" scale=".15 2.5 .05" side="double" ></a-box>
       <a-box position="0 0 -.6" rotation="0 0 0" material="src: #M1diffuse; roughnessMap: #M1roughness; normalMap: #M!normal; repeat:1 1; flatShading: true; receiveShadow:true; castShadow: true" scale=".15 2.5 .05" side="double"></a-box>
       <a-box position="0 1.25 0" rotation="0 0 0" material="src: #M1diffuse; roughnessMap: #M1roughness; normalMap: #M!normal; repeat:1 1; flatShading: true; receiveShadow:true; castShadow: true" scale=".15 .05 1.25" side="double" ></a-box>
       <!-- Pomo -->
       <a-sphere position="-.11 -.1 .4" radius=".04" material="src: #M2diffuse; roughnessMap: #M2roughness; normalMap: #M2normal; metalnessMap: #M2metalness; repeat:2 2; flatShading: true; receiveShadow:true; castShadow: true"></a-sphere></a-entity>
      </a-entity>
      <!-- Video -->
      <a-entity 
       position="3 2 -5.5">
       <!-- Texto -->
       <a-entity
         text-geometry="value: Videoteca; bevelEnabled: true; align:center; bevelSize: 0.015; bevelThickness: 0.01; curveSegments: 5"
         material="shader: standard; color:#000000"
         Scale="1 1 1" 
         rotation="0 0 0" 
         position="-1.6 1 0"
         scale="0.1 0.1 0.1">
       </a-entity>
       <!-- Video -->
       <a-video 
         id="video" 
         src="#historia" 
         width="16" 
         height="9" 
         position="0 0 0" 
         scale=".2 .2. .2">
       </a-video>
       <!-- Esfera play -->
       <a-sphere 
         id="playSphere" 
         position="-1 -.5 0" 
         radius="0.2" 
         color="#EF2D5E"
         animation__click="property: scale; startEvents: click; to: 1.1 1.1 1.1; dir: alternate"
         animation__color="property: color; startEvents: click; to: #FF0000; dir: alternate"
         animation__reset="property: scale; startEvents: reset; delay: 2000; dur: 500; to: 1 1 1"
         animation__resetColor="property: color; startEvents: reset; delay: 2000; dur: 500; to: #EF2D5E">
         <!-- Texto -->
          <a-text 
           value="Play" align="center" 
           color="#FFFFFF" 
           position="0 0 0.21">
         </a-text>
       </a-sphere>
       <!-- esfera pausa -->
       <a-sphere 
         id="pauseSphere" 
         position="1 -.5 0"
         radius="0.2" 
         color="#FFC65D"
         animation__click="property: scale; startEvents: click; to: 1.1 1.1 1.1; dir: alternate"
         animation__color="property: color; startEvents: click; to: #0000FF; dir: alternate"
         animation__reset="property: scale; startEvents: reset; delay: 2000; dur: 500; to: 1 1 1"
         animation__resetColor="property: color; startEvents: reset; delay: 2000; dur: 500; to: #FFC65D">
         <!-- Texto -->
         <a-text 
           value="Pause" 
           align="center" 
           color="#FFFFFF" 
           position="0 0 0.21">
         </a-text>
       </a-sphere>
      </a-entity>
      <!-- Script funcionamiento -->
      <script>
        var videoEl = document.querySelector('#video');
        var video = document.querySelector('#historia');
        var playSphere = document.querySelector('#playSphere');
        var pauseSphere = document.querySelector('#pauseSphere');
      
        playSphere.addEventListener('click', function () {
          video.play();
          playSphere.emit('reset');
        });
      
        pauseSphere.addEventListener('click', function () {
          video.pause();
          pauseSphere.emit('reset');
        });
      </script>

      <!-- Reproductor -->
      <a-entity 
       sound="src: #backgroundMusic" 
       id="sonido">
      </a-entity>
      <!-- Mueble -->
      <a-entity 
       position="5 .5 .5" 
       rotation="0 -90 0">
        <!-- Caja mueble -->
        <a-box 
         position="0 .25 0" 
         scale="2 1 .5"  
         material="src: #M1diffuse; roughnessMap: #M1roughness; normalMap: #M!normal; repeat:1 1; flatShading: true; receiveShadow:true; castShadow: true">
        </a-box>
        <!-- Grabadora -->
        <a-entity 
         gltf-model="#rockola" 
         material="flatShading: true; metalness: 0; roughness: 1; castShadow: true; receiveShadow: true" 
         scale=".5 .5 .5" 
         position="0 .76 0">
        </a-entity>
        <!-- disco -->
        <a-image 
         id="disco"
         src="#discoBeatles" 
         position="0 2 0" 
         scale=".8 .8 .8" 
         rotation="0 0 0" >
        </a-image>
        <!-- Controles de reproducción -->
        <!-- Play -->
        <a-box 
         id="playButton" 
         position="-.8 .8 0" 
         color="#4CC3D9" 
         scale=".3 .3 .3">
          <a-text 
           value="Play" align="center" 
           color="#FFFFFF" 
           position="0 1 0" 
           scale="2 2 2">
          </a-text>
        </a-box>
        <!-- pausa -->
        <a-box 
         id="pauseButton" 
         position=".8 .8 0" 
         color="#EF2D5E" 
         scale=".3 .3 .3">
          <a-text 
           value="Pause" 
           align="center" 
           color="#FFFFFF" 
           position="0 1 0" 
           scale="2 2 2">
          </a-text>
        </a-box>
      </a-entity>
      <!-- Script reproduccion -->
      <script>
        var sonido = document.querySelector('#sonido');
        var disco = document.querySelector('#disco');
        var playButton = document.querySelector('#playButton');
        var pauseButton = document.querySelector('#pauseButton');
    
        playButton.addEventListener('click', function () {
          sonido.components.sound.playSound();
          disco.setAttribute('animation', 'property: rotation; to: 0 0 360; loop: true; dur: 1000; easing: linear');
        });
    
        pauseButton.addEventListener('click', function () {
          sonido.components.sound.pauseSound();
          disco.removeAttribute('animation');
          disco.setAttribute('animation', 'property: rotation; to: 0 0 0; dur: 1000; easing: linear');
        });
      </script>




    </a-scene>

      <div class="a-loader-title" style="display: none;">Proyecto</div>
    </a-scene>
  </body>
</html>